(()=>{"use strict";var e={nameSelector:".profile__info-name",occupationSelector:".profile__info-occupation",editButton:".profile__edit-btn",addCardButton:".profile__add-btn"},t={formSelector:".form",inputSelector:".form__input",submitButtonSelector:".form__save-btn",inactiveButtonClass:"form__save-btn_disabled",inputErrorClass:"form__input-error",errorClass:"form__input-error-msg_active"};function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var r=function(){function e(t,n,r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._name=t.name,this._link=t.link,this._templateSelector=n,this._handleCardClick=r,this}var t,r;return t=e,(r=[{key:"generateDomElement",value:function(){var e=document.querySelector(this._templateSelector).content;return this._element=e.querySelector(".element").cloneNode(!0),this._initCardPhoto(),this._initCardName(),this._initCardLikeButton(),this._initTrashButton(),this._element}},{key:"getImage",value:function(){return{name:this._name,link:this._link}}},{key:"_initCardPhoto",value:function(){var e=this,t=this._element.querySelector(".element__photo");t.src=this._link,t.alt=this._name,t.addEventListener("click",(function(t){e._handleCardClick({name:e._name,link:e._link})}))}},{key:"_initCardName",value:function(){this._element.querySelector(".element__name").textContent=this._name}},{key:"_initCardLikeButton",value:function(){this._element.querySelector(".element__like-btn").addEventListener("click",this._toggleLike.bind(this))}},{key:"_initTrashButton",value:function(){this._element.querySelector(".element__trash-btn").addEventListener("click",this._removeCard.bind(this))}},{key:"_toggleLike",value:function(e){e.target.classList.toggle("element__like-btn_active")}},{key:"_removeCard",value:function(){this._element.remove(),this._element=null}}])&&n(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=function(){function e(t,n){var r,o,i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),o=function(e){e.validity.valid?i._hideInputError(e):i._showInputError(e)},(r="_renderInputValidityState")in this?Object.defineProperty(this,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):this[r]=o,this._validationOptions=t,this._formElement=n}var t,n;return t=e,(n=[{key:"enableValidation",value:function(){var e=this;this._inputList=Array.from(this._formElement.querySelectorAll(this._validationOptions.inputSelector)),this._submitButton=this._formElement.querySelector(this._validationOptions.submitButtonSelector),this._errorMessageElements=this._findErrorMessageElements(this._formElement,this._inputList),this._inputList.forEach((function(t){t.addEventListener("input",(function(){return e._validateInput(t)}))}))}},{key:"hideFormErrorMessages",value:function(){var e=this;this._inputList.forEach((function(t){return e._hideInputError(t)}))}},{key:"validateForm",value:function(){var e=this;this._inputList.forEach((function(t){return e._renderInputValidityState(t)})),this._renderSubmitButtonValidityState()}},{key:"_validateInput",value:function(e){this._renderInputValidityState(e),this._renderSubmitButtonValidityState()}},{key:"_findErrorMessageElements",value:function(e,t){var n={};return t.forEach((function(t){var r=".".concat(t.id,"-error");n[t.id]=e.querySelector(r)})),n}},{key:"_hideInputError",value:function(e){e.classList.remove(this._validationOptions.inputErrorClass);var t=this._errorMessageElements[e.id];t.textContent="",t.classList.remove(this._validationOptions.errorClass)}},{key:"_showInputError",value:function(e){e.classList.add(this._validationOptions.inputErrorClass);var t=this._errorMessageElements[e.id];t.textContent=e.validationMessage,t.classList.add(this._validationOptions.errorClass)}},{key:"_renderSubmitButtonValidityState",value:function(){this._hasInvalidData(this._inputList)?this._disableSubmitButton():this._enableSubmitButton()}},{key:"_hasInvalidData",value:function(e){return e.some((function(e){return!e.validity.valid}))}},{key:"_disableSubmitButton",value:function(){this._submitButton.classList.add(this._validationOptions.inactiveButtonClass),this._submitButton.setAttribute("disabled","true")}},{key:"_enableSubmitButton",value:function(){this._submitButton.classList.remove(this._validationOptions.inactiveButtonClass),this._submitButton.removeAttribute("disabled")}}])&&o(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._popupSelector=t,this._setElements(),this._escapeEventListener=this._handleEscClose.bind(this)}var t,n;return t=e,(n=[{key:"open",value:function(){this._element.classList.add(u.popupOpenClass),document.addEventListener("keyup",this._escapeEventListener)}},{key:"close",value:function(){document.removeEventListener("keyup",this._escapeEventListener),this._element.classList.remove(u.popupOpenClass)}},{key:"setEventListeners",value:function(){this._addOverlayClickEventListeners(),this._addCloseButtonEventListeners()}},{key:"_setElements",value:function(){this._element=document.querySelector(this._popupSelector),this._closeButton=this._element.querySelector(u.popupCloseButton),this._popupContainer=this._element.querySelector(u.popupContainer)}},{key:"_handleEscClose",value:function(e){"Escape"===e.key&&this.close()}},{key:"_addCloseButtonEventListeners",value:function(){var e=this;this._closeButton.addEventListener("click",(function(){return e.close()}))}},{key:"_addOverlayClickEventListeners",value:function(){var e=this;this._popupContainer.addEventListener("mousedown",(function(e){e.stopImmediatePropagation()})),this._element.addEventListener("mousedown",(function(){e.close()}))}}])&&a(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),u={popupCloseButton:".popup__close-btn",popupOpenClass:"popup_opened",popupContainer:".popup__container"};function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(){return f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=p(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},f.apply(this,arguments)}function p(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=h(e)););return e}function d(e,t){return d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},d(e,t)}function m(e,t){if(t&&("object"===l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}var _=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(r);if(o){var n=h(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return m(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e))._setContainerElements(),t}return t=a,(n=[{key:"open",value:function(e){var t=e.name,n=e.link;this._imageElement.src=n,this._imageElement.alt=t,this._nameElement.textContent=t,f(h(a.prototype),"open",this).call(this)}},{key:"_setContainerElements",value:function(){this._imageElement=this._element.querySelector(".card-details__photo"),this._nameElement=this._element.querySelector(".card-details__name")}}])&&c(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(s);function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function b(){return b="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=E(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},b.apply(this,arguments)}function E(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=w(e)););return e}function k(e,t){return k=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},k(e,t)}function g(e,t){if(t&&("object"===y(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return S(e)}function S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w(e){return w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},w(e)}var O=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&k(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=w(r);if(o){var n=w(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return g(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e))._submitCallback=t.bind(S(n)),n._setFormElements(),n}return t=a,(n=[{key:"setEventListeners",value:function(){var e=this;b(w(a.prototype),"setEventListeners",this).call(this),this._formElement.addEventListener("submit",(function(t){t.preventDefault(),e._submitCallback(e._getInputValues()),e.close()}))}},{key:"close",value:function(){b(w(a.prototype),"close",this).call(this),this.reset()}},{key:"reset",value:function(){this._formElement.reset()}},{key:"setValues",value:function(e){this._inputList.forEach((function(t){t.value=e[t.name]}))}},{key:"_getInputValues",value:function(){var e={};return this._inputList.forEach((function(t){e[t.name]=t.value})),e}},{key:"_setFormElements",value:function(){this._formElement=this._element.querySelector(".form"),this._submitButtonElement=this._formElement.querySelector(".form__save-btn"),this._inputList=Array.from(this._formElement.querySelectorAll(".form__input"))}}])&&v(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(s);function C(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var L=function(){function e(t){var n=t.nameSelector,r=t.occupationSelector;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._nameElement=document.querySelector(n),this._occupationElement=document.querySelector(r)}var t,n;return t=e,(n=[{key:"getUserInfo",value:function(){return{name:this._nameElement.textContent,occupation:this._occupationElement.textContent}}},{key:"setUserInfo",value:function(e){var t=e.name,n=e.occupation;this._nameElement.textContent=t,this._occupationElement.textContent=n}}])&&C(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var B=function(){function e(t,n){var r=t.items,o=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._items=r,this._renderer=o.bind(this),this._containerSelector=n,this._setElements()}var t,n;return t=e,(n=[{key:"renderItems",value:function(){var e=this;this._container.innerHTML="",this._items.forEach((function(t){return e._renderer(t)}))}},{key:"addItem",value:function(e){this._container.prepend(e)}},{key:"_setElements",value:function(){this._container=document.querySelector(this._containerSelector)}}])&&j(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function P(e){var n=new i(t,document.forms[e]);return n.enableValidation(),n}var I=P("profile"),q=P("card"),x=document.querySelector(e.editButton),R=document.querySelector(e.addCardButton);function T(e){M.open(e)}function V(e){return new r(e,"#element-template",T).generateDomElement()}var D=new B({items:[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:function(e){var t=V(e);D.addItem(t)}},".elements__list");D.renderItems();var M=new _(".popup_view-card");M.setEventListeners();var F=new L(e),A=new O(".popup_edit-profile",(function(e){F.setUserInfo(e)}));A.setEventListeners();var U=new O(".popup_add-card",(function(e){D.addItem(V(e))}));U.setEventListeners(),x.addEventListener("click",(function(){A.setValues(F.getUserInfo()),I.validateForm(),A.open()})),R.addEventListener("click",(function(){q.validateForm(),q.hideFormErrorMessages(),U.open()}))})();